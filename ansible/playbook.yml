---
# Nexus Homelab Ansible Playbook
# Usage: ansible-playbook playbook.yml --extra-vars "services=plex,jellyfin"

- name: Deploy Nexus Homelab
  hosts: localhost
  connection: local
  vars_files:
    - vars/vault.yml

  pre_tasks:
    - name: Display deployment information
      ansible.builtin.debug:
        msg:
          - "Services to deploy: {{ services | default('all') }}"
          - "Domain: {{ domain | default('not set') }}"
          - "Nexus Root: {{ nexus_root_directory | default(ansible_facts['env']['HOME'] + '/dev/nexus') }}"

  roles:
    - role: docker
      tags: ['docker', 'setup']

    - role: nexus
      tags: ['nexus', 'deploy']
      vars:
        nexus_services: "{{ services | default('all') }}"
