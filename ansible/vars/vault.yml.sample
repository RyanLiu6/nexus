---
# =============================================================================
# Nexus Encrypted Secrets
# =============================================================================
#
# Copy to vault.yml and encrypt:
#   cp ansible/vars/vault.yml.sample ansible/vars/vault.yml
#   ansible-vault encrypt ansible/vars/vault.yml
#
# Edit encrypted vault:
#   ansible-vault edit ansible/vars/vault.yml
#
# Password Generation Commands:
#   - Passwords:    openssl rand -base64 24
#   - Long secrets: openssl rand -base64 32
#   - Hex secrets:  openssl rand -hex 32
#   - Long hex:     openssl rand -hex 64
#
# Instructions:
#   1. Configure the "Core Configuration" section (required for all deployments)
#   2. Configure secrets for services you plan to use
#   3. Leave unused service secrets as "CHANGE_ME" - they won't be used
#
# =============================================================================

# #############################################################################
#                           CORE CONFIGURATION
#                    (Required for all deployments)
# #############################################################################

# =============================================================================
# Nexus Paths and Settings
# =============================================================================
# Where nexus is cloned (e.g., /home/user/dev/nexus or ~/dev/nexus)
nexus_root_directory: "/path/to/nexus"

# Data directory for service volumes (configs, backups, media)
# macOS: ~/Data or /Volumes/Data
# Linux: /data
# Structure:
#   - ${nexus_data_directory}/Config/   - container settings and data
#   - ${nexus_data_directory}/Backups/  - backup storage
#   - ${nexus_data_directory}/Media/    - media files for Plex/Jellyfin
nexus_data_directory: "/path/to/data"

# Your domain (e.g., example.com)
nexus_domain: "example.com"

# Timezone (find yours: https://en.wikipedia.org/wiki/List_of_tz_database_time_zones)
tz: "America/Vancouver"

# User/Group IDs for media services (jellyfin, plex, transmission, nextcloud)
# Find your IDs: id -u (PUID) and id -g (PGID)
# Leave as 1000 for most single-user systems
puid: 1000
pgid: 1000

# =============================================================================
# Cloudflare - DNS, Tunnel, and Gateway (Zero Trust)
# =============================================================================
# Get API token from: https://dash.cloudflare.com/profile/api-tokens
# Required permissions:
#   - Zone:DNS:Edit
#   - Zone:Zone:Read
#   - Account:Cloudflare Tunnel:Edit
#   - Account:Zero Trust:Edit (for Gateway DNS filtering)
#   - Account:Workers R2 Storage:Edit (for FoundryVTT R2 bucket provisioning)
#   User Permissions:
#   - User:API Tokens:Read (to look up permission policies)
#   - User:API Tokens:Edit (to create Foundry-specific access tokens)
cloudflare_api_token: "CHANGE_ME"

# Find Zone ID on your domain's Overview page in Cloudflare dashboard
cloudflare_zone_id: "CHANGE_ME"

# Find Account ID in URL: dash.cloudflare.com/<account-id>/... or Account Settings
cloudflare_account_id: "CHANGE_ME"

# Email for Let's Encrypt SSL certificates
acme_email: "your-email@example.com"

# Cloudflare Tunnel secret (no port forwarding needed!)
# Generate with: openssl rand -hex 32
tunnel_secret: "CHANGE_ME"

# Tailscale server IP for Gateway split DNS (resolves *.domain to this IP)
# Find with: tailscale ip -4
# Leave empty to skip split DNS (only use Gateway for ad-blocking)
tailscale_server_ip: ""

# #############################################################################
#                           CORE SERVICES
#                    (traefik, auth, dashboard, monitoring)
# #############################################################################

# =============================================================================
# Traefik - Reverse Proxy
# =============================================================================
# Uses cloudflare_api_token for DNS challenge SSL certificates
# No additional secrets required - uses ACME_EMAIL and CLOUDFLARE_DNS_API_TOKEN

# =============================================================================
# Tailscale Configuration
# =============================================================================
# Your Tailnet ID (Unique ID found under Settings -> General)
tailnet_id: "your-tailnet-id"

# Tailscale API key for ACL and DNS management (required)
#
# To create an API key:
#   1. Go to https://login.tailscale.com/admin/settings/keys
#   2. Click "Generate API key..."
#   3. Set expiration (max 90 days) - you'll need to rotate periodically
#   4. Copy the key (starts with "tskey-api-")
#
# The key grants full admin access to your tailnet. Keep it secure.
tailscale_api_key: ""

# =============================================================================
# Tailscale Users & Groups
# =============================================================================
# Define user emails here - this is the SINGLE SOURCE OF TRUTH for access control.
# Terraform applies ACL and DNS automatically on deploy.
#
# Group behavior:
#   - admins: Full network access (all ports + SSH)
#   - other groups: Web-only access (ports 80, 443)
tailscale_users:
  admins:
    - "your-email@gmail.com"
  members:
    - "friend1@gmail.com"
    - "friend2@gmail.com"
  finance:
    - "accountant@gmail.com"

# =============================================================================
# Dashboard (Homepage)
# =============================================================================
# No secrets required - uses NEXUS_DOMAIN and TZ

# =============================================================================
# Monitoring - Prometheus, Grafana, Alertmanager
# =============================================================================
# Grafana admin credentials (for API access only - users login via Tailscale Header Auth)
grafana_admin_user: "admin"
grafana_admin_password: "CHANGE_ME"  # openssl rand -base64 24

# =============================================================================
# Vaultwarden - Password Manager (Optional but recommended)
# =============================================================================
# Admin panel access token (Argon2 hash)
# Generate with: docker run --rm -it vaultwarden/server /vaultwarden hash
# You'll be prompted for a password - save both the password and resulting hash
# Use the PASSWORD to access /admin panel, store the HASH here
vaultwarden_admin_token: "CHANGE_ME"

# Disable new user signups (use invitations instead for security)
vaultwarden_signups_allowed: "false"

# Allow admins to invite users via admin panel
vaultwarden_invitations_allowed: "true"

# #############################################################################
#                           OPTIONAL SERVICES
#                     (Configure only what you use)
# #############################################################################

# =============================================================================
# Discord Alerting (Optional)
# =============================================================================
# Leave empty to disable Discord alerts
# Get webhook URL from: Discord Server Settings > Integrations > Webhooks

discord_webhook_url: ""

# =============================================================================
# Backups - Borgmatic (Optional but recommended)
# =============================================================================
# Borg repository encryption passphrase
# IMPORTANT: Store this securely! Without it, backups are unrecoverable
# Generate with: openssl rand -base64 32
borg_passphrase: "CHANGE_ME"

# =============================================================================
# Sure - Personal Finance (Optional)
# =============================================================================
# PostgreSQL database credentials
sure_postgres_user: "sure_user"
sure_postgres_password: "CHANGE_ME"  # openssl rand -base64 32
sure_postgres_db: "sure_production"

# Rails secret key base
# Generate with: openssl rand -hex 64
sure_secret_key_base: "CHANGE_ME"

# Internal port (usually don't need to change)
sure_port: "5006"

# AI Configuration - Choose ONE option:

# Option 1: Local AI with Ollama (RECOMMENDED for privacy)
# Setup: brew install ollama && ollama pull qwen2.5:7b
# Then: cd services/sure && ollama create ena -f Modelfile
sure_openai_access_token: "ollama-local"
sure_openai_uri_base: "http://host.docker.internal:11434/v1"
sure_openai_model: "ryanliu6/ena:latest"

# Option 2: OpenAI
# sure_openai_access_token: "<openai_api_key_here>"
# sure_openai_uri_base: ""
# sure_openai_model: "gpt-4o"

# Option 3: Claude (via Anthropic API)
# sure_openai_access_token: "<anthropic_api_key_here>"
# sure_openai_uri_base: "https://api.anthropic.com/v1"
# sure_openai_model: "claude-sonnet-4-20250514"

# Option 4: OpenRouter (access multiple providers)
# sure_openai_access_token: "<openrouter_api_key_here>"
# sure_openai_uri_base: "https://openrouter.ai/api/v1"
# sure_openai_model: "deepseek/deepseek-chat"

# =============================================================================
# Donetick - Task & Chore Management (Optional)
# =============================================================================
# JWT secret for session tokens
# Generate with: openssl rand -base64 32
donetick_jwt_secret: "CHANGE_ME"

# Donetick R2 Storage (populated from Terraform outputs)
# TERRAFORM-MANAGED: When deploying with Terraform (default), these values are
# automatically provisioned and passed via extra-vars. Manual configuration is
# only needed when using --skip-dns or managing R2 buckets outside Terraform.
#
# To use vault values instead of Terraform:
#   1. Deploy with --skip-dns flag
#   2. Set the values below manually
# Endpoint: https://<account_id>.r2.cloudflarestorage.com
donetick_r2_endpoint: "CHANGE_ME"
donetick_r2_access_key: "CHANGE_ME"
donetick_r2_secret_key: "CHANGE_ME"
donetick_r2_bucket: "donetick-storage"

# =============================================================================
# Paperless-ngx - Document Management (Optional)
# =============================================================================
# PostgreSQL database credentials
paperless_postgres_user: "paperless"
paperless_postgres_password: "CHANGE_ME"  # openssl rand -base64 32
paperless_postgres_db: "paperless"

# Secret key for Django (application security)
# Generate with: openssl rand -hex 64
paperless_secret_key: "CHANGE_ME"

# Admin user credentials (created on first run)
paperless_admin_user: "admin"
paperless_admin_password: "CHANGE_ME"  # openssl rand -base64 24

# =============================================================================
# Booklore - Book Library Manager (Optional)
# =============================================================================
# MariaDB database credentials
booklore_mysql_user: "booklore"
booklore_mysql_password: "CHANGE_ME"  # openssl rand -base64 32
booklore_mysql_root_password: "CHANGE_ME"  # openssl rand -base64 32

# =============================================================================
# Nextcloud - File Storage (Optional)
# =============================================================================
# MariaDB (MySQL) database credentials
mysql_user: "nextcloud"
mysql_password: "CHANGE_ME"  # openssl rand -base64 32
mysql_database: "nextcloud"
mysql_root_password: "CHANGE_ME"  # openssl rand -base64 32

# =============================================================================
# FoundryVTT - Virtual Tabletop (Optional)
# =============================================================================
# Your foundryvtt.com account credentials (for license validation)
foundry_username: "your-foundryvtt-username"
foundry_password: "CHANGE_ME"

# Admin key for Foundry setup page
# Generate with: openssl rand -base64 24
foundry_admin_key: "CHANGE_ME"

# Cloudflare R2 Storage (S3 Compatible) configuration
# TERRAFORM-MANAGED: When deploying with Terraform (default), these values are
# automatically provisioned and passed via extra-vars. Manual configuration is
# only needed when using --skip-dns or managing R2 buckets outside Terraform.
#
# To use vault values instead of Terraform:
#   1. Deploy with --skip-dns flag
#   2. Set the values below manually
# Endpoint: https://<account_id>.r2.cloudflarestorage.com
foundry_s3_endpoint: "CHANGE_ME"
foundry_s3_access_key: "CHANGE_ME"
foundry_s3_secret_key: "CHANGE_ME"
foundry_s3_bucket: "foundry-assets"

# =============================================================================
# Jellyfin - Media Server (Optional)
# =============================================================================
# No secrets required - uses NEXUS_DOMAIN and TZ
# Media paths configured via data_directory

# =============================================================================
# Plex - Media Server (Optional)
# =============================================================================
# No secrets required - uses NEXUS_DOMAIN and TZ
# Claim token obtained via plex.tv/claim during setup

# =============================================================================
# Transmission - Torrent Client (Optional)
# =============================================================================
# No secrets required - protected by Tailscale Access
# Uses NEXUS_DOMAIN and TZ

# #############################################################################
#                           ENVIRONMENT VARIABLE MAPPING
# #############################################################################
# This section maps vault variables to the environment variables used by
# docker-compose files. The Ansible playbook handles this mapping.
#
# Variable Name in Vault     -> Docker Env Variable
# -------------------------  -> --------------------
# nexus_root_directory       -> NEXUS_ROOT_DIRECTORY
# nexus_data_directory       -> NEXUS_DATA_DIRECTORY
# nexus_domain               -> NEXUS_DOMAIN
# tz                         -> TZ
# cloudflare_api_token       -> CLOUDFLARE_DNS_API_TOKEN
# acme_email                 -> ACME_EMAIL
# grafana_admin_password     -> GRAFANA_ADMIN_PASSWORD
# borg_passphrase            -> BORG_PASSPHRASE
# sure_postgres_user         -> SURE_POSTGRES_USER
# sure_postgres_password     -> SURE_POSTGRES_PASSWORD
# sure_postgres_db           -> SURE_POSTGRES_DB
# sure_secret_key_base       -> SURE_SECRET_KEY_BASE
# sure_openai_access_token   -> SURE_OPENAI_ACCESS_TOKEN
# sure_openai_uri_base       -> SURE_OPENAI_URI_BASE (if set)
# sure_openai_model          -> SURE_OPENAI_MODEL (if set)
# mysql_user                 -> MYSQL_USER
# mysql_password             -> MYSQL_PASSWORD
# mysql_database             -> MYSQL_DATABASE
# mysql_root_password        -> MYSQL_ROOT_PASSWORD
# foundry_username           -> FOUNDRY_USERNAME
# foundry_password           -> FOUNDRY_PASSWORD
# foundry_admin_key          -> FOUNDRY_ADMIN_KEY
# tailnet_id                 -> TAILNET_ID
# tailscale_api_key          -> TAILSCALE_API_KEY
# vaultwarden_admin_token    -> VAULTWARDEN_ADMIN_TOKEN
# vaultwarden_signups_allowed -> VAULTWARDEN_SIGNUPS_ALLOWED
# vaultwarden_invitations_allowed -> VAULTWARDEN_INVITATIONS_ALLOWED
# donetick_jwt_secret        -> DONETICK_JWT_SECRET
# paperless_postgres_user    -> PAPERLESS_POSTGRES_USER
# paperless_postgres_password -> PAPERLESS_POSTGRES_PASSWORD
# paperless_postgres_db      -> PAPERLESS_POSTGRES_DB
# paperless_secret_key       -> PAPERLESS_SECRET_KEY
# paperless_admin_user       -> PAPERLESS_ADMIN_USER
# paperless_admin_password   -> PAPERLESS_ADMIN_PASSWORD
# booklore_mysql_user        -> BOOKLORE_MYSQL_USER
# booklore_mysql_password    -> BOOKLORE_MYSQL_PASSWORD
# booklore_mysql_root_password -> BOOKLORE_MYSQL_ROOT_PASSWORD
# puid                       -> PUID
# pgid                       -> PGID
